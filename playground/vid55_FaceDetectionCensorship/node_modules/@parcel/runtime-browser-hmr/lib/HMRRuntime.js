"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _plugin = require("@parcel/plugin");

var _fs = _interopRequireDefault(require("fs"));

var _utils = require("@parcel/utils");

var _path = _interopRequireDefault(require("path"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const HMR_RUNTIME = _fs.default.readFileSync(_path.default.join(__dirname, './loaders/hmr-runtime.js'), 'utf8');

var _default = new _plugin.Runtime({
  apply({
    bundle,
    options
  }) {
    if (bundle.type !== 'js' || !options.hot) {
      return;
    }

    if (typeof options.hot !== 'object') {
      throw new Error('options.hot should be an object, otherwise the HMR Runtime has no clue what port to use');
    }

    return {
      filePath: __filename,
      code: `var __PARCEL_HMR_ENV_HASH = "${(0, _utils.md5FromObject)(bundle.env)}";` + HMR_RUNTIME,
      isEntry: true
    };
  }

});

exports.default = _default;