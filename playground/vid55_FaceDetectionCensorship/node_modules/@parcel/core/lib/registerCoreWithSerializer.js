"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = registerCoreWithSerializer;

var _utils = require("@parcel/utils");

var _AssetGraph = _interopRequireDefault(require("./AssetGraph"));

var _BundleGraph = _interopRequireDefault(require("./BundleGraph"));

var _Graph = _interopRequireDefault(require("./Graph"));

var _ParcelConfig = _interopRequireDefault(require("./ParcelConfig"));

var _RequestGraph = _interopRequireDefault(require("./RequestGraph"));

var _Config = _interopRequireDefault(require("./public/Config"));

var _package = _interopRequireDefault(require("../package.json"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// $FlowFixMe this is untyped
const packageVersion = _package.default.version;

if (typeof packageVersion !== 'string') {
  throw new Error('Expected package version to be a string');
}

let registered;

function registerCoreWithSerializer() {
  if (registered) {
    return;
  }

  for (let ctor of [_AssetGraph.default, _Config.default, _BundleGraph.default, _Graph.default, _ParcelConfig.default, _RequestGraph.default]) {
    register(ctor);
  }

  registered = true;
}

function register(ctor) {
  (0, _utils.registerSerializableClass)(packageVersion + ':' + ctor.name, ctor);
}