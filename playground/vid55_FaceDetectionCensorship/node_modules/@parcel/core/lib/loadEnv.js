"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = loadEnv;

var _config = require("@parcel/utils/src/config");

var _dotenv = _interopRequireDefault(require("dotenv"));

var _dotenvExpand = _interopRequireDefault(require("dotenv-expand"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

async function loadEnv(filePath) {
  const NODE_ENV = process.env.NODE_ENV == null ? 'development' : process.env.NODE_ENV;
  const dotenvFiles = [`.env.${NODE_ENV}.local`, `.env.${NODE_ENV}`, // Don't include `.env.local` for `test` environment
  // since normally you expect tests to produce the same
  // results for everyone
  NODE_ENV === 'test' ? null : '.env.local', '.env'].filter(Boolean);
  await Promise.all(dotenvFiles.map(async dotenvFile => {
    const envPath = await (0, _config.resolveConfig)(filePath, [dotenvFile]);

    if (envPath != null) {
      const envs = _dotenv.default.config({
        path: envPath
      });

      (0, _dotenvExpand.default)(envs);
    }
  }));
}